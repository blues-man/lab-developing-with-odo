FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBsYWItZGV2ZWxvcGluZy13aXRoLW9kbwpkZXNjcmlwdGlv\
bjogQVBCIHRvIGRlcGxveSBEZXZlbG9waW5nIHdpdGggb2RvIFdvcmtzaG9wIG9uIGFuIE9wZW5T\
aGlmdCBjbHVzdGVyCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKdGFnczoKLSB3b3Jr\
c2hvcAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogbGFiLWRldmVsb3Bpbmctd2l0aC1vZG8KICBs\
b25nRGVzY3JpcHRpb246IHwtCiAgICBJbnN0YWxscyBhIHdvcmtzaG9wIHNwYXduZXIgZm9yIERl\
dmVsb3BpbmcgYXBwbGljYXRpb25zIHdpdGggb2RvIHdvcmtzaG9wCiAgY29uc29sZS5vcGVuc2hp\
ZnQuaW8vaWNvbkNsYXNzOiAiZmEgZmEtaG9tZSIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVk\
IEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogRGVw\
bG95cyBEZXZlbG9waW5nIHdpdGggb2RvIFdvcmtzaG9wCiAgICBmcmVlOiBUcnVlCiAgICBtZXRh\
ZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERlZmF1bHQKICAgIHBhcmFtZXRlcnM6CiAgICAtIG5h\
bWU6IGFkbWluX3VzZXIKICAgICAgdGl0bGU6IEFkbWluIFVzZXJuYW1lCiAgICAgIGRlc2NyaXB0\
aW9uOiBVc2VyIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBwcm9qZWN0IGFkbWluIHJlc291cmNl\
cwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGlzcGxheV90\
eXBlOiB0ZXh0CiAgICAgIGRpc3BsYXlfZ3JvdXA6IEluc3RhbGwgVXNlcgogICAgLSBuYW1lOiBh\
ZG1pbl9wYXNzd29yZAogICAgICB0aXRsZTogQWRtaW4gUGFzc3dvcmQKICAgICAgZGVzY3JpcHRp\
b246IFBhc3N3b3JkIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBwcm9qZWN0IGFkbWluIHJlc291\
cmNlcwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGlzcGxh\
eV90eXBlOiBwYXNzd29yZAogICAgICBkaXNwbGF5X2dyb3VwOiBJbnN0YWxsIFVzZXIKICAgIC0g\
bmFtZTogdXNlcl9jb3VudAogICAgICB0aXRsZTogTnVtYmVyIG9mIHNlc3Npb25zCiAgICAgIGRl\
c2NyaXB0aW9uOiBOdW1iZXIgb2YgY29uY3VycmVudCBzZXNzaW9ucyBhbGxvd2VkIGZvciB0aGUg\
d29ya3Nob3AuCiAgICAgIHR5cGU6IG51bWJlcgogICAgICBkZWZhdWx0OiAzMAogICAgICByZXF1\
aXJlZDogZmFsc2UKICAgICAgZGlzcGxheV9ncm91cDogV29ya3Nob3AKICAgIC0gbmFtZTogaWRs\
ZV90aW1lb3V0CiAgICAgIHRpdGxlOiBJZGxlIHRpbWVvdXQKICAgICAgZGVzY3JpcHRpb246IFRp\
bWUgaW4gc2Vjb25kcyBmb3IgdGhlIHNlc3Npb24gdG8gYmUgaWRsZSBiZWZvcmUgaXQgdGltZXNv\
dXQuCiAgICAgIHR5cGU6IG51bWJlcgogICAgICBkZWZhdWx0OiA5MAogICAgICByZXF1aXJlZDog\
ZmFsc2UKICAgICAgZGlzcGxheV9ncm91cDogV29ya3Nob3AKICAgIC0gbmFtZTogbWF4X3Nlc3Np\
b25fYWdlCiAgICAgIHRpdGxlOiBNYXggc2Vzc2lvbiBhZ2UKICAgICAgZGVzY3JpcHRpb246IE1h\
eGltdW0gdGltZSBhIHNlc3Npb24gd2lsbCBsaXZlLiBJbiBzZWNvbmRzLgogICAgICB0eXBlOiBu\
dW1iZXIKICAgICAgZGVmYXVsdDogMzYwMAogICAgICByZXF1aXJlZDogZmFsc2UKICAgICAgZGlz\
cGxheV9ncm91cDogV29ya3Nob3AKICAgIC0gbmFtZTogc3Bhd25lcl90ZW1wbGF0ZV92ZXJzaW9u\
CiAgICAgIHRpdGxlOiBTcGF3bmVyIHZlcnNpb24gdG8gdXNlCiAgICAgIGRlc2NyaXB0aW9uOiBW\
ZXJzaW9uIG9mIHRoZSBzcGF3bmVyIHRlbXBsYXRlIHRvIHVzZSB3aGVuIGRlcGxveWluZyBob21l\
cm9vbQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogIjMuMC44IgogICAgICByZXF1\
aXJlZDogZmFsc2UKICAgICAgZGlzcGxheV9ncm91cDogQWR2YW5jZWQKICAgIC0gbmFtZTogd29y\
a3Nob3BfaW1hZ2VfbmFtZQogICAgICB0aXRsZTogV29ya3Nob3AgaW1hZ2UgbmFtZQogICAgICBk\
ZXNjcmlwdGlvbjogTmFtZSBvZiB0aGUgd29ya3Nob3AgaW1hZ2UgdG8gdXNlIGZvciB0aGlzIGxh\
YgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogInF1YXkuaW8vb3BlbnNoaWZ0bGFi\
cy9sYWItZGV2ZWxvcGluZy13aXRoLW9kbyIKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICAgIGRp\
c3BsYXlfZ3JvdXA6IEFkdmFuY2VkCiAgICAtIG5hbWU6IHdvcmtzaG9wX2ltYWdlX3RhZwogICAg\
ICB0aXRsZTogV29ya3Nob3AgaW1hZ2UgdGFnCiAgICAgIGRlc2NyaXB0aW9uOiBUYWcgb2YgdGhl\
IHdvcmtzaG9wIGltYWdlIHRvIHVzZSBmb3IgdGhpcyBsYWIKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgIGRlZmF1bHQ6ICJzdW1taXQtMjAxOSIKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICAgIGRp\
c3BsYXlfZ3JvdXA6IEFkdmFuY2VkCg=="

COPY playbooks /opt/apb/actions
COPY . /opt/ansible
RUN chmod -R g=u /opt/{ansible,apb}
# RUN curl -kL https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64 -o /usr/local/bin/jq && chmod 755 /usr/local/bin/jq
USER apb
