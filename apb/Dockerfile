FROM ansibleplaybookbundle/apb-base:release-1.3

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBsYWItZGV2ZWxvcGluZy13aXRoLW9kby1hcGIKZGVzY3Jp\
cHRpb246IEFQQiB0byBkZXBsb3kgRGV2ZWxvcGluZyB3aXRoIG9kbyBXb3Jrc2hvcCBvbiBhbiBP\
cGVuU2hpZnQgY2x1c3RlcgpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFsCnRhZ3M6Ci0g\
d29ya3Nob3AKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJvZG8gV29ya3Nob3AgSW5zdGFsbGVy\
IgogIGxvbmdEZXNjcmlwdGlvbjogfC0KICAgIEluc3RhbGxzIGEgd29ya3Nob3Agc3Bhd25lciBm\
b3IgRGV2ZWxvcGluZyBhcHBsaWNhdGlvbnMgd2l0aCBvZG8gd29ya3Nob3AKICBjb25zb2xlLm9w\
ZW5zaGlmdC5pby9pY29uQ2xhc3M6ICJmYSBmYS1ob21lIgogIHByb3ZpZGVyRGlzcGxheU5hbWU6\
ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9u\
OiBEZXBsb3lzIERldmVsb3Bpbmcgd2l0aCBvZG8gV29ya3Nob3AKICAgIGZyZWU6IFRydWUKICAg\
IG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgcGFyYW1ldGVyczoKICAg\
IC0gbmFtZTogYWRtaW5fdXNlcgogICAgICB0aXRsZTogQWRtaW4gVXNlcm5hbWUKICAgICAgZGVz\
Y3JpcHRpb246IFVzZXIgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIHByb2plY3QgYWRtaW4gcmVz\
b3VyY2VzCiAgICAgIHR5cGU6IHN0cmluZwogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBkaXNw\
bGF5X3R5cGU6IHRleHQKICAgICAgZGlzcGxheV9ncm91cDogSW5zdGFsbCBVc2VyCiAgICAtIG5h\
bWU6IGFkbWluX3Bhc3N3b3JkCiAgICAgIHRpdGxlOiBBZG1pbiBQYXNzd29yZAogICAgICBkZXNj\
cmlwdGlvbjogUGFzc3dvcmQgaXMgcmVxdWlyZWQgZm9yIGNyZWF0aW5nIHByb2plY3QgYWRtaW4g\
cmVzb3VyY2VzCiAgICAgIHR5cGU6IHN0cmluZwogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBk\
aXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEluc3RhbGwgVXNlcgog\
ICAgLSBuYW1lOiB1c2VyX2NvdW50CiAgICAgIHRpdGxlOiBOdW1iZXIgb2Ygc2Vzc2lvbnMKICAg\
ICAgZGVzY3JpcHRpb246IE51bWJlciBvZiBjb25jdXJyZW50IHNlc3Npb25zIGFsbG93ZWQgZm9y\
IHRoZSB3b3Jrc2hvcC4KICAgICAgdHlwZTogbnVtYmVyCiAgICAgIGRlZmF1bHQ6IDMwCiAgICAg\
IHJlcXVpcmVkOiBmYWxzZQogICAgICBkaXNwbGF5X2dyb3VwOiBXb3Jrc2hvcAogICAgLSBuYW1l\
OiBpZGxlX3RpbWVvdXQKICAgICAgdGl0bGU6IElkbGUgdGltZW91dAogICAgICBkZXNjcmlwdGlv\
bjogVGltZSBpbiBzZWNvbmRzIGZvciB0aGUgc2Vzc2lvbiB0byBiZSBpZGxlIGJlZm9yZSBpdCB0\
aW1lc291dC4KICAgICAgdHlwZTogbnVtYmVyCiAgICAgIGRlZmF1bHQ6IDkwCiAgICAgIHJlcXVp\
cmVkOiBmYWxzZQogICAgICBkaXNwbGF5X2dyb3VwOiBXb3Jrc2hvcAogICAgLSBuYW1lOiBtYXhf\
c2Vzc2lvbl9hZ2UKICAgICAgdGl0bGU6IE1heCBzZXNzaW9uIGFnZQogICAgICBkZXNjcmlwdGlv\
bjogTWF4aW11bSB0aW1lIGEgc2Vzc2lvbiB3aWxsIGxpdmUuIEluIHNlY29uZHMuCiAgICAgIHR5\
cGU6IG51bWJlcgogICAgICBkZWZhdWx0OiAzNjAwCiAgICAgIHJlcXVpcmVkOiBmYWxzZQogICAg\
ICBkaXNwbGF5X2dyb3VwOiBXb3Jrc2hvcAogICAgLSBuYW1lOiBzcGF3bmVyX3RlbXBsYXRlX3Zl\
cnNpb24KICAgICAgdGl0bGU6IFNwYXduZXIgdmVyc2lvbiB0byB1c2UKICAgICAgZGVzY3JpcHRp\
b246IFZlcnNpb24gb2YgdGhlIHNwYXduZXIgdGVtcGxhdGUgdG8gdXNlIHdoZW4gZGVwbG95aW5n\
IGhvbWVyb29tCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiAiMy4wLjgiCiAgICAg\
IHJlcXVpcmVkOiBmYWxzZQogICAgICBkaXNwbGF5X2dyb3VwOiBBZHZhbmNlZAogICAgLSBuYW1l\
OiB3b3Jrc2hvcF9pbWFnZV9uYW1lCiAgICAgIHRpdGxlOiBXb3Jrc2hvcCBpbWFnZSBuYW1lCiAg\
ICAgIGRlc2NyaXB0aW9uOiBOYW1lIG9mIHRoZSB3b3Jrc2hvcCBpbWFnZSB0byB1c2UgZm9yIHRo\
aXMgbGFiCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiAicXVheS5pby9vcGVuc2hp\
ZnRsYWJzL2xhYi1kZXZlbG9waW5nLXdpdGgtb2RvIgogICAgICByZXF1aXJlZDogZmFsc2UKICAg\
ICAgZGlzcGxheV9ncm91cDogQWR2YW5jZWQKICAgIC0gbmFtZTogd29ya3Nob3BfaW1hZ2VfdGFn\
CiAgICAgIHRpdGxlOiBXb3Jrc2hvcCBpbWFnZSB0YWcKICAgICAgZGVzY3JpcHRpb246IFRhZyBv\
ZiB0aGUgd29ya3Nob3AgaW1hZ2UgdG8gdXNlIGZvciB0aGlzIGxhYgogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgZGVmYXVsdDogInN1bW1pdC0yMDE5IgogICAgICByZXF1aXJlZDogZmFsc2UKICAg\
ICAgZGlzcGxheV9ncm91cDogQWR2YW5jZWQK"

COPY playbooks /opt/apb/actions
COPY . /opt/ansible
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
